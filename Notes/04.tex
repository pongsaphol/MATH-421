\chapter{Differenitiation}

Office hours on Monday

\begin{enumerate}
  \item Office hour 6.pm to 7.pm on Monday
  \item can meet before 8:50 am Monday in my office Van Vleck 613 (send an email on sunday)
\end{enumerate}

Consider a function defined on on interval $I$, with real values.
$f: I \to \RR$

\begin{definition*}
  $f$ is differentiable at the point $a \in I$ if the limit $\lim\limits_{x \to a} \frac{f(x) - f(a)}{x - a}$  exists,
  then we call this limit the deriviative $f'(a)$
\end{definition*}

\begin{center}
  \begin{tikzpicture}
    \draw[->] (-1, 0) -- (4.2, 0) node[right] {$x$};
    \draw[->] (0, -1) -- (0, 4.2) node[above] {$f(x)$};
    \draw[scale=1, domain=0.3:3.5, smooth, variable=\x] plot ({\x}, {\x^2/4});

    \draw[dotted] (2, -0.5) -- (2, 4) node[above] {$$};
    \draw[dotted] (2.5, -0.5) -- (2.5, 4) node[above] {$$};
    \draw[-] (2, 1) -- (2.5, 1) node[above] {$$};
    \draw[-] (2.5, 1) -- (2.5, 1.5625) node[above] {$$};
    \node[] at (2.25,0.8) {$x-a$};
    \node[] at (4,1.25) {$f(x) - f(a)$};
    \node[] at (2,-0.2) {$a$};
    \node[] at (2.5,-0.2) {$x$};
  \end{tikzpicture}

  $y = f(x)$, $\frac{f(x) - f(a)}{x-a} = $ slope of $f$
\end{center}

Computation of some derivatives

\begin{example*}
  \text{ }
  \begin{enumerate}[(i)]
    \item $f(x) = c$ ($c$ is some fixed point)
      we get $f'(a) = 0$ for all $a$, 

      $f(x) = f(a) = 0$ for all $x$, $\frac{f(x) - f(a)}{x-a} = 0 \implies f$ is differentiable and $f'(a) = 0$ for all $a$

      $\lim\limits_{x \to a} \frac{f(x) - f(a)}{x-a} = f'(x)$ is equivalent with saying $\lim\limits_{h \to 0} \frac{f(a+h) - f(a)}{h} = f'(a)$
    \item $f(x) = x$, then $$\frac{f(a+h) - f(a)}{h} = \frac{a + h - a}{h} = 1$$ (written $f'(x) = 1$)

    \item $f(x) = x^2$, then fix $a$, $$\frac{f(a + h) - f(a)}{h} = \frac{(a+h)^2 - a^2}{h} = \frac{a^2 + 2ah + h^2 - a^2}{h} = 2a + h$$
    $$\lim\limits_{h \to 0} \frac{f(a+h) - f(a)}{h} = \lim\limits_{h \to 0}2a + h = 2a$$
    \item $f(x) = |x|$, We should examine the differentiability of $f$ at \underline{$a = 0$}
    $$\frac{f(0 + h) - \overbrace{f(0)}^{=0}}{h} = \frac{|h|}{h} =\begin{cases}
      1       & \quad \text{if } h > 0\\
      -1  & \quad \text{if } h < 0
    \end{cases}$$
    The limit does not exist, and thus $f$ is not differentiable at $0$.
    \item $f(x) = \sqrt{|x|}$, $f$ is not differentiable at $0$ because $f(0) = 0$ and $\frac{f(0 + h) - f(0)}{h} = \frac{\sqrt{|h|}}{h}$, this limit also does not exist 

    Examine differentiability and derivative of $f(x) = \sqrt{|x|}$ at $x = a, a > 0$
    \begin{align*}
    \frac{f(a + h) - f(a)}{h} &= \frac{\sqrt{|a + h|} - \sqrt{|a|}}{h} \\
    &= \frac{\sqrt{a + h} - \sqrt{a}}{h} \\
    &= \frac{a+h - a}{\sqrt{a + h} + \sqrt{a}}\cdot \frac{1}{h} \\
    &= \frac{1}{\sqrt{a + h} + \sqrt{a}} \to \frac{1}{2\sqrt{a}}\\
    \end{align*}
    \item $f(x) = x^n$ 
    $$\frac{f(a+h) - f(a)}{h} = \frac{(a + h) ^ n - a^n}{h} = n\cdot a^{n-1}$$
  \end{enumerate}
\end{example*}

\section{Basic fact about differentiation}

Continuity is necessary (but not sufficient) for differentiation 

\begin{theorem*}
  If $f: I \to \RR$ is differentiable at $a$ the $f$ is continuous at $a$.
\end{theorem*}

\textbf{Reminder} If $\lim\limits_{x \to a} F(x) = l$ and $\lim\limits_{x \to a} G(x) = m$, then $\lim\limits_{x \to a} F(x)G(x)= lm$

If $\lim\limits_{x \to a} F(x) = l$ and $\lim\limits_{x \to a} G(x) = m$, then $\lim\limits_{x \to a} \frac{F(x)}{G(x)}= \frac{l}{m}$ or not? Yes if $m \neq 0$

\begin{proof}
  We know that $\lim\limits_{x \to 0} \frac{f(a + h) - f(a)}{h} = f'(a)$
  $$f(a + h) - f(a) = \frac{f(a + h) - f(a)}{h} \cdot h$$
  $$\implies \lim\limits_{h \to 0} f(a + h) - f(a) = f'(a) \cdot 0 = 0$$
  $$\lim\limits_{h \to 0} f(a + h) = f(a)$$ 
  this is continuity of $f$ at $a$
  
  Another argument : for sufficiently small $h$, $|f(a + h) - f(a)| \leq C|h|$
\end{proof}

\section{Sum Rule}

\begin{theorem*}
  Let $f: I \to \RR$ and $g: I \to \RR$, $a\in I$ assume that $f$ and $g$ are differentiable at $a$. 
  Then $f + g$, $(f + g)(x) = f(x) + g(x)|_{x = a}$ is differentiable and its derivative $f'(a) + g'(a)$
  (The derivative of the sum is the sum of the derivatiives)
\end{theorem*}

\begin{proof}
  \begin{align*}
    \frac{(f+g)(a + h) - (f+g)(a)}{h} &= \frac{f(a + h) + g(a + h) - (f(a) + g(a))}{h} \\
    &= \frac{f(a + h) - f(a)}{h} + \frac{g(a + h) - g(a)}{h} \\
  \end{align*}
  As $h \to 0$ this has limit $f'(a) + g'(a)$
\end{proof}

\section{Product Rule}

\begin{theorem*}
  Let $f: I \to \RR$ and $g: I \to \RR$, $a\in I$ assume that $f$ and $g$ are differentiable at $a$. 
  the $f\cdot g$ is differentiable at $a$
  $$(f\cdot g)'(a) = f'(a)g(a) + f(a)g'(a)$$
\end{theorem*}
\begin{proof}
  \begin{align*}
    \frac{f(a + h)g(a + h) - f(a)g(a)}{h} &= \frac{(f(a+h) - f(a))g(a+h) + f(a)g(a+h) - f(a)g(a)}{h} \\
    &= \underbrace{\frac{f(a+h) - f(a)}{h}}_{f'(a)}\cdot \underbrace{g(a+h)}_{\to g(a)} + \underbrace{\frac{g(a + h) - g(a)}{h}}_{\to g'(a)} \cdot \underbrace{f(a)}_{f(a)} \\
  \end{align*}
  By theorem about products and of limits, and the continuity of $g$ at $a$, we get

  $$\lim\limits_{h \to 0} \frac{f(a+h)g(a+h) - f(a)g(a)}{h} = f'(a)g(a) + g'(a)f(a)$$
\end{proof}


\begin{theorem*}
  Let $f: I \to \RR$ and $g: I \to \RR$, $a\in I$ is differentiable at $a$, and if $g(a) \neq 0$
  then $\frac{1}{g}$ is differentiable at $a$ and $$\left(\frac{1}{g}\right)'(a) = -\frac{g'(a)}{(g(a))^2}$$
  % $$\left(\frac{f}{g}\right)'(a) = \frac{f'g - fg'}{g^2} |_a$$
\end{theorem*}
\begin{proof}
  \begin{align*}
    \frac{\frac{1}{g(a+h)} - \frac{1}{g(a)}}{h} &= \frac{g(a) - g(a + h)}{g(a+h)g(a)}\cdot\frac{1}{h} \\
    &= \frac{1}{g(a+h)g(a)}\cdot (-1)\frac{g(a+h) - g(a)}{h} \\
    &\to \frac{1}{(g(a))^2}\cdot (-1) g'(a) 
  \end{align*}
\end{proof}


\section{Quotient Rule}
\begin{theorem*}
  Let $f: I \to \RR$ and $g: I \to \RR$, $a\in I$ assume $f$ and $g$ are differentiable at $a$, and if $g(a) \neq 0$
  then $\frac{f}{g}$ is differentiable at $a$ and $$\left(\frac{f}{g}\right)'(a) = \frac{f'(a)g(a) - f(a)g'(a)}{g(a)^2}$$
\end{theorem*}
\begin{proof}
  Combine the theorems about products and reciprocals of differentiable function

  \begin{align*}
  \left(\frac{f}{g}\right)'(a) &= \left(f \cdot \frac{1}{g}\right)'(a) \\
  &= f'(a) \cdot \frac{1}{g(a)} + f(a) \cdot \left(\frac{1}{g}\right)'(a) \\
  &= \frac{f'(a)}{g(a)} + f(a)\left(-\frac{g'(a)}{g(a)^2}\right) \\
  &= \frac{f'(a)g(a) - f(a)g'(a)}{g(a)^2}
  \end{align*}
\end{proof}

\begin{example*}
  \begin{align*}
    \left(\frac{\sin x}{\cos x}\right)' &= \frac{\sin'(x) \cos(x) - \cos' x \sin x}{(\cos x)^2} \\
    &= \frac{(\cos x)^2 - (-\sin ^2 x)}{(\cos x)^2} \\
    &= \frac{1}{(\cos x)^2} \\
  \end{align*}
\end{example*}

\begin{example*}
  $f(x) = x^n$ then
  $f'(x) = n x^{n-1}$
\end{example*}
\begin{proof}
  $$f_0(x) = 1, f_0'(x) = 0$$
  $$f_1(x) = x, f_1'(x) = 1$$
  $$f_1(x) = x^2, f_2'(x) = 2x$$
  We want to show this formula for a given $n$, assuming that we already know if for $n = 1$,
  In other words, the formula $f_{n-1}'(x) = (n-1)x^{n-1}, n \geq 2$,
  implies the formula for $f_n$

  Induction step: $$f_n(x) = x^n = \underbrace{x^{n-1}}_{f_{n-1}} \cdot \underbrace{x}_{f_1}$$
  By using Product Rule, we get
  \begin{align*}
  f_n'(x) &= f_{n-1}'(x)f_1(x) + f_{n-1}(x)f_1'(x) \\
  &= (n-1)x^{n-1} \cdot x + x^{n-1} \cdot 1 \\
  &= nx^{n-1} 
  \end{align*}
\end{proof}

\begin{example*}
  \begin{align*}
    (fg)'' &= (f'g + fg')' \\
    &= (f'g)' + (fg')' \\
    &= f''g + f'g' + f'g' + fg'' \\
    &= f''g + 2f'g' + fg'' \\
  \end{align*}
  $(fg)''' = f'''g + 3f''g' + 3f'g'' + fg'''$
  and can be written as $(fg)^{(3)}$
  $$(fg)^{(n)}(x) = \sum_{k=0}^n \binom{n}{k} f^{(k)}(x)g^{(n-k)}(x)$$
  As the analogy
  $$(a + b)^n = \sum_{k=0}^n \binom{n}{k} a^k b^{n-k}$$
\end{example*}

We will not talk much about higher derivative in this class

\section{Chain Rule}

Let $\zeta(x) = f(g(x))$
Assume that $g$ is defined on an interval containing $a$, and $g$ is differentiable at \underline{$a$}.
Let $f$ be defined in an interval that contain the range (image) of $g$, and let $f$ be differentiable at $g(a)$.
then, $\zeta = f \circ g$ is differentiable at $a$ and $$\zeta'(a) = f'(g(a))g'(a)$$


\begin{example*}
  $$F(x) = (x^3 + 7x^2 + 1)^8$$
  Fix a point $a$, what $F'(a)$
  
  
  Let $F(x) = f(g(x))$, $g(x) = x^3 + 7x^2 + 1$ and $f(w) = w^8$

  First, calculate $f'$ and $g'$
  $$f'(w) = 8w^7$$ 
  $$g'(x) = 3x^2 + 14x$$
  Then cancluate $F'(x)$
  \begin{align*}
  F'(x) &= f'(g(x))g'(x) \\
  &= 8(g(x))^7 \cdot (3x^2 + 14x) \\
  &= 8(x^3 + 7x^2 + 1)^7 \cdot (3x^2 + 14x) \\
  \end{align*}
\end{example*}

Attempt to prove the chain rule

\begin{proof}
  \begin{align*}
    \frac{\zeta(a+h) - \zeta(a)}{h} &= \frac{f(g(a+h)) - f(g(a))}{h} \\
    &= \underbrace{\frac{f(g(a+h)) - f(g(a))}{g(a+h) - g(a)}}_{\to f'(g(a))} \cdot \underbrace{\frac{g(a+h) - g(a)}{h}}_{\to g'(a)}
  \end{align*}
  But $g(a+h) - g(a)$ might be equal to $0$, So, we can't use this method to prove the chain rule.
\end{proof}

\begin{theorem*}[Decomposition theorem for differentation]
  The function $f$ is differentiable at $a$ (with derivative $f'(a)$) \underline{if and only if} 
  there is another function $u$ with the same domain as $f$, 
  so that $u$ is continuous at $a$ and $$f(x) = f(a) + (x-a)u(x)$$
  Then $$u(a) = f'(a)$$

\end{theorem*}

\begin{proof}
  % \begin{enumerate}[(i)]
    Assume that $f$ is differentiable at $a$, $f'(a)$ is the derivative
  \[
    u(x) = \begin{cases}
      \frac{f(x) - f(a)}{x-a} & \text{if } x \neq a \\
      f'(a) & \text{if } x = a
    \end{cases} 
  \]
  ($u$ depends on $a$ but $a$ is fixed)

  $u$ is continuous at $a$ because $\lim\limits_{x \to a} \frac{f(a+h) - f(a)}{h} = f'(a) = u(a)$
  % \item Assume that $f(x) = f(x) + (x-a)u(x)$ for some function that is continuous at $a$ (for all $x$ in the domain of $f$)
  
  % Then I claim that $f$ is differentiable at $a$, $u(a) = f'(a)$ for $x = a + h, h \neq 0, x \neq a$, 
  % $$\frac{f(x) - f(a)}{x-a} = (x-a)u(x)$$
  
  % $u$ is continuous at $a$, implies $u(x) \to u(a)$ as $x \to a$

  % \underline{fact}: $f(g(x))$, $f$ is differentiable at $g(a)$

  % $$g(x) = g(a) + (x-a)u(x)\ u \text{ continuous at }a$$
  % $$f(w) = f(g(a)) + (w - g(a))v(w)$$

  % $u$ is continuous at $a$, $u(a) = g'(a)$

  % $v$ is continuous at $g(a)$, $v(g(a)) = f'(g(a))$

  % $$f(g(x)) = f(g(a)) + (g(x) - g(a))v(g(x))$$
  % \end{enumerate}


  Suppose that $$\zeta(x) = f(g(x)) \implies \zeta'(a) = f'(g(a))g'(a)$$
  \textbf{Assumption}
  \begin{enumerate}[(1)]
    \item $g$ is differentiable at $a$
    \item $f$ is differentiable at $g(a)$
  \end{enumerate}
  we can write 
  $$g(x) = g(a) + (x-a)u(x)\ \ast$$
  where $u$ is continuous at $a$, $g'(a) = u(a)$, and
  $$f(y) = f(g(a)) + (y - g(a))v(y)\ \ast \ast $$
  where $v$ is continuous at $g(a)$, $v(g(a)) = f'(g(a))$

  \underline{\textbf{Goal}} is to find a function $w$ continuous at $a$ such that 
  $$\zeta(x) = \zeta(a) + (x - a)w(x)$$
  with $w(a) = f'(g(a))g'(a)$

  from $\ast \ast $, $$f(g(x)) = f(g(a)) + (g(x) - g(a))\underbrace{v(g(x))}_{\text{cts at }a}$$
  from $\ast $, $$f(g(x)) = f(g(a)) + (x-a)\underbrace{u(x)v(g(x))}_{\text{cts at }a}$$
  Then, we get 
  $$w(x):= u(x)v(g(x))$$
  and
  $$w(a) = u(a)v(g(a)) = g'(a)f'(g(a))$$
\end{proof}

\section{Geometric meaning of Differentiation}

\begin{theorem*}
  Let $f$ be defined on an interval $I$ and let $a$ be a point in the interior of this interval.

  \underline{Assume:}
  \begin{enumerate}
    \item $f$ has a maximum at $a$
    \item $f$ is differentiable at $a$
  \end{enumerate}
  Then, $f'(a) = 0$ 
  
  formally $f$ has a maximum in $I$ at $a$, means $f(x) \leq f(a)$ for all $x \in I$
  (Also works for $\min$ in place of $\max$)
\end{theorem*}

\begin{proof}
  We know by the assumption $\lim\limits_{x\to a} \frac{f(x) - f(a)}{x - a} = f'(x)$ exists.

  \begin{enumerate}
    \item If $x > a$ then $f(x) \leq f(a) \implies \frac{f(x) - f(a)}{x - a} \leq 0$ (slope of right side $\leq 0$)
    \item If $x < a$ then $f(x) \leq f(a)$ but now $x - a < 0$,$ \frac{f(x) - f(a)}{x - a} \geq 0$ (slope of left side $\geq 0$)
  \end{enumerate}

  So, $\lim\limits_{x\to a} \frac{f(x) - f(a)}{x - a}$ has to be $\geq 0$ and $\leq 0$, so it must be $0$.

\end{proof}

\section{Mean-Value Theorem}

\begin{theorem*}[Mean-value theorem]
  Let $f$ be defined on $\left[a, b\right]$ and $f$ continuous in $\left[a, b\right]$ and differentiable in $(a, b)$. 
  Then there is a $\xi \in (a, b)$ such that $$f'(\xi) = \frac{f(b) - f(a)}{b-a}$$
\end{theorem*}

\begin{proof}
  First step in the proof is a \underline{special} case where $f(a) = f(b)$
  (then there is a $\xi \in (a, b)$ such that $f'(\xi) = 0$)
  \begin{enumerate}
    \item if $f$ has a $\max$ and a $\min$ at the endpoint, $f$ is contant and therefore $f'(\xi) = 0$ for all $\xi \in (a, b)$
    \item if $f$ has a maximum and a minimum in $(a, b)$, then we know already, at such a point, the derivative is $0$,
    so at that point $\xi \implies f'(\xi) = 0$
  \end{enumerate}
  This particular case is called ``\textit{Rolle's theorem}''

  Consider $$g(x) = f(x) - f(a) - \frac{f(b) - f(a)}{b-a}(x-a)$$
  Then, $g(a) = 0$ and $g(b) = 0$ and $g$ is continuous in $(a, b)$
  $$g'(x) = f'(x) - \frac{f(b) - f(a)}{b-a}$$
  Apply ``\textit{Rolle's theorem}'' to $g$ on $(a, b)$, we get a $\xi \in (a, b)$ such that $g'(\xi) = 0$
\end{proof}

Aforementioned theorem can be written as $$f(b) - f(a) = f'(\xi) (b-a)$$

\section{Application of the Mean-Value Theorem}

\begin{example*}
  Prove $|\sin x| \leq |x|$
\end{example*}
\begin{proof}
  We know that $\sin 0 = 0$ and $\sin'x = \cos x$

  $$\sin x = \sin x - \underbrace{\sin 0}_{=0} = \sin'(\xi)(x-0)$$

  where $\xi$ is between $0$ and $x$
  $$\begin{cases}
    0 < \xi < x & \text{if } x > 0\\
    x < \xi < 0 & \text{if } x < 0
  \end{cases}$$
  So, $\sin x = (\cos \xi) x$, where $-1 \leq \cos \xi \leq 1 \implies |\cos\xi| \leq 1$

  Therefore,
  $$|\sin x| = |\cos\xi|\cdot|x| \leq |x|$$
\end{proof}

\begin{example*}
  Can we get an estimate for $\cos x - 1$ where $x$ is small?
  $$\cos x - 1 = \cos x - \cos 0 = \cos'(\xi)(x-0) = (-\sin \xi) x$$
  We get $|\cos x - 1| \leq |x|$
  
  Can do better
  \begin{align*}
    |\cos x - 1| &\leq |(\sin \xi)|\cdot|x|\ \text{ for } \xi \text{ between } 0 \text{ and } x\\
    &\leq |\xi|\cdot|x| \leq |x|^2\\
  \end{align*}
  for $|x| < 1$ this is a better estimate than the previous one
\end{example*}

\begin{theorem*}
  If $f$ is differentiable on $(a, b)$ and if $f'(x) = 0$ for all $x\in(a, b)$ then $f$ is constant.
\end{theorem*}

\begin{proof}
  take $x_1 < x_2$, both in the interval and apply the \textit{MVT} 
  $$f(x_2) - f(x_1) = f'(\xi)(x_2-x_1),\ x_1 < \xi < x_2$$ 
  we know $f'(\xi) = 0 \implies f(x_2) - f(x_1) = 0 \implies f(x_2) = f(x_1)$

  So, $f$ is constant function
\end{proof}

\begin{example*}
  for a differential equation

  Q: Find $f(x)$ (differentiable, for $x > 0$) such that 
  $$x f'(x) = f(x)$$
\end{example*}

\begin{proof}
  By guessing $f(x) = x$ is a solution because $f'(x) = 1, x\cdot 1 = x$
  
  In fact, for any constant $C$, $f(x) = Cx$ is a solution.

  Show that for an arbitrary solution $g$, $xg'(x) = g(x)$ for $x > 0$
  try to show that $\frac{g(x)}{x}$ is constant

  To do this, show that the derivative of $\frac{g(x)}{x}$ is zero
  
  $$\frac{g(x)}{x} = \frac{g'(x)x-g(x)\cdot 1}{x^2} = 0,\text{ since } g \text{ satisfies the differential equation}$$
  So, $\frac{g(x)}{x}$ is constant
\end{proof}

\begin{example*}
  $$xf'(x)=af(x)$$
  $Cx^a$ is a solution
\end{example*}

\begin{proof}
  Conjecture: All solutions are of the form $f(x) = Cx^a$

  Let $g$ be a solution of the equation, we have $xg'(x) = ag(x)$
  Consider 
  \begin{align*}
    \left(\frac{g(x)}{x^a}\right)' &= \frac{g'(x)x^a-g(x)ax^{a-1}}{x^{2a}} \\
    &= \frac{x^{a-1}}{x^{2a}}\cdot \underbrace{(g'(x)x - ag(x))}_{=0}\\
  \end{align*}
  So, $\frac{g(x)}{x^a}$ is constant, so $g(x) = Cx^a$ for some $C$
\end{proof}

\begin{theorem*}[A]
  If $f, f'$ are differentiable on $(a, b)$ if $f'(c) = 0$ and $f''(x) > 0$ for all $x$ in $(a, b)$ 
  then $f$ has a minimum at $c$
\end{theorem*}

\begin{theorem*}[B]
  \text{}
  \begin{enumerate}[a)]
    \item 
    If $g$ is a differentiable function on $(a, b)$ such that 
    $g'(x) > 0$ on $(a, b)$ then $g$ is strictly increasing

    i.e., if $x_1 < x_2$ then $g(x_1) < g(x_2)$
    \item If $g(x) < 0$ on $(a, b)$ then $g$ is decreasing
  \end{enumerate}
\end{theorem*}
\begin{proof}[Proof of Theorem B]
  If $x_1 < x_2$, apply MVT
  $$g(x_2) - g(x_1) = \underbrace{g'(\xi)}_{ > 0}\underbrace{(x_2 - x_1)}_{ > 0} > 0$$
\end{proof}